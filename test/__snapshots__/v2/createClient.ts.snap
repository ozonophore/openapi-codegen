/* istanbul ignore file */
/* tslint:disable */
/* eslint-disable */

import { OpenAPI } from './core/OpenAPI';
import type { TOpenAPIConfig } from './core/OpenAPI';
import { createExecutorAdapter } from './core/executor/createExecutorAdapter';
import { RequestInterceptor, ResponseInterceptor, ErrorInterceptor } from './core/interceptors/interceptors';
import { withInterceptors } from './core/interceptors/withInterceptors';
import { apiErrorInterceptor } from './core/interceptors/apiErrorInterceptor';

import { V2Service } from './services/V2Service';
import { SimpleService } from './services/SimpleService';
import { ParametersService } from './services/ParametersService';
import { DefaultsService } from './services/DefaultsService';
import { DuplicateService } from './services/DuplicateService';
import { NoContentService } from './services/NoContentService';
import { ResponseService } from './services/ResponseService';
import { CollectionFormatService } from './services/CollectionFormatService';
import { TypesService } from './services/TypesService';
import { ComplexService } from './services/ComplexService';
import { HeaderService } from './services/HeaderService';

export interface ClientOptions<TExecutorOptions extends Record<string, any>> {
    openApi?: Partial<TOpenAPIConfig>;
    interceptors?: {
        onRequest?: RequestInterceptor[];
        onResponse?: ResponseInterceptor[];
        onError?: ErrorInterceptor[];
    };
}

export function createClient<TExecutorOptions extends Record<string, any>>(
    options: ClientOptions<TExecutorOptions> = {},
) {
    const openApiConfig: TOpenAPIConfig = {
        ...OpenAPI,
        ...options.openApi,
    };

    let executor = createExecutorAdapter<TExecutorOptions>(openApiConfig);
    if (options?.interceptors) {
        executor = withInterceptors(executor, {
            onError: [apiErrorInterceptor, ...(options.interceptors?.onError ?? [])],
            onRequest: options.interceptors?.onRequest,
            onResponse: options.interceptors?.onResponse,
        });
    }

    return {
        V2Service: new V2Service(executor),
        SimpleService: new SimpleService(executor),
        ParametersService: new ParametersService(executor),
        DefaultsService: new DefaultsService(executor),
        DuplicateService: new DuplicateService(executor),
        NoContentService: new NoContentService(executor),
        ResponseService: new ResponseService(executor),
        CollectionFormatService: new CollectionFormatService(executor),
        TypesService: new TypesService(executor),
        ComplexService: new ComplexService(executor),
        HeaderService: new HeaderService(executor),
    };
}
