# Журнал изменений

Здесь документируются все заметные изменения в этом проекте.

Формат основан на Keep a Changelog, и проект следует правилам семантического версионирования.

## [1.0.0-beta.8] - 2025-12-06

### Добавлено
- Добавлена команда CLI инструмента `init-openapi-config`. Формирует шаблон файла конфигурации для запуска генерации кода по файлам спецификаций openapi.
- Добавлен параметр для указания файла конфигурации (по умолчанию: `openapi.config.json`) в команду CLI инструмента `check-openapi-config`.
- Добавлен параметр для указания файла конфигурации (по умолчанию: `openapi.config.json`) в команду CLI инструмента `generate`.
- Добавлен файл шаблона (hbs) для формирования файла конфигурации (по умолчанию: `openapi.config.json`).

### Изменено
- Изменено расположение шаблонов (hbs файлы) для генерации кода по спецификациям openapi.

## [1.0.0-beta.7] - 2025-11-30

### Добавлено
- Обновлены примеры CLI и схема конфигурации (example/openapi.config.json) и README.md в соответствии с новыми параметрами CLI.
- Добавлены и обновлены тесты и утилиты, связанные с поведением WriteClient.

### Изменено
- Интерфейс CLI — обновлён набор параметров командной строки и логика валидации:
  - Переименованы и реорганизованы несколько флагов и опций в src/cli/index.ts и src/cli/utils.ts.
  - Обновлена обработка опций и код миграции в src/common/VersionedSchema/* и src/common/Options.ts для поддержки новой формы опций.
- Рефакторинг WriteClient:
  - Переработаны внутренности WriteClient (src/core/WriteClient.ts) и связанные хелперы (src/core/utils/writeClient*.ts) для более надёжной работы ввода/вывода, обработки ошибок и более чёткого разделения ответственности.
  - Адаптированы тесты: src/core/__tests__/WriteClient.test.ts и несколько юнит-тестов writeClient в src/core/utils/__tests__.
- Обновлены версии схем опций и планы миграций (src/common/VersionedSchema/*) для поддержки новых форматов конфигурации.

### Исправлено
- Генерация путей/импортов в Parser.getType (v3):
  - Не добавлять префикс "./" к путям, которые уже начинаются с "." (например "../...") или "/" (абсолютные).
  - Не добавлять запись об импорте, если разрешённый путь пустой.
  - Сохранено корректное поведение при переходах по каталогам и безопасных откатах при разрешении parentRef.
  - Изменения внесены в src/core/api/v3/parser/getType.ts (и при необходимости — в v2).
- Утилиты:
  - Исправлены и стабилизированы хелперы для разрешения путей: resolveRefToImportPath, getAbsolutePath и связанные тесты.
  - Скорректовано поведение getGatheringRefs и соответствующие ожидания в тестах.
- Тесты:
  - Обновлены многие unit-тесты для соответствия исправленному поведению путей и импортов (см. src/core/api/**/__tests__ и src/core/utils/__tests__).

### Обновлено
- Обновлены unit-тесты по всему проекту, чтобы согласовать их с изменённой логикой разрешения путей, поведением WriteClient и параметрами CLI.
- Обновлена документация и примеры (README, example/).

### Примечания
- Изменения в основном внутренние и касаются тестов/CLI. Публичный API генерируемых клиентов остаётся совместимым, однако конфигурация CLI/опции изменились — рекомендуется ознакомиться с примерами и планом миграции.

## [1.0.0-beta.6] - 2025-08-22

### Добавлено
- Добавлена команда для проверки файла конфигурации;
- Добавлен механизм проверки и уведомления о завершениях;

### Исправлено
- Рефакторинг: улучшена логика обработки сгенерированных данных и записи файлов на диск;
- Исправлен шаблон "IsReadOnly": ранее свойство с атрибутом readonly генерировалось неправильно — добавлен переход на новую строку.

## [1.0.0-beta.5] - 2025-08-09

### Добавлено
- Добавлена функция упрощённой сортировки аргументов для сервисных функций. Упрощённая стратегия похожа на используемую в версии 0.2.3 OpenAPI генератора;
- Добавлена функция расширённой сортировки аргументов сервисных функций;
- Добавлен флаг выбора стратегии сортировки аргументов в CLI инструменты;

### Обновлено
- Обновлено описание в README.

## [1.0.0-beta.4] - 2025-08-02

### Добавлено
- Добавлен механизм сопоставления входного набора параметров со списком недопустимых значений;
- Добавлено определение наиболее подходящей версии схемы;
- Добавлены unit-тесты для новых функций;

### Обновлено
- Обновлена функция для сбора уникальных ключей из массива схем валидации параметров.

## [1.0.0-beta.3] - 2025-07-24

### Добавлено
- Добавлен логгер с использованием npm-пакета winston;
- Добавлена функция преобразования массива опций в модель multiple option;
- Добавлено заполнение Joi схемы для набора опций и проверка значений по умолчанию;
- Добавлен подсчёт времени, затраченного на генерацию кода, с выводом в терминал;

### Исправлено
- Исправлен план миграции для multiple options;
- Исправлены unit-тесты для миграции наборов опций;

## [1.0.0-beta.2] - 2025-07-22

### Добавлено
- Механизм сопоставления разных версий наборов параметров генератора для обеспечения обратной совместимости;
- Механизм обнаружения опечаток при использовании опций генератора через CLI или файл конфигурации;
- Проверка CLI опций инструмента на наличие значений по умолчанию для дальнейших сценариев действий;
- Утилита для обработки служебных слов в именах (шаблоны);

### Обновлено
- Модели наборов опций генератора для запуска генерации были изменены;
- Код CLI инструмента перемещён в каталог cli, внесены правки в логику перед генерацией;
- Дублирующие участки кода объединены;

## [1.0.0-beta.1] - 2025-06-27

### Добавлено
- Добавлены snapshot unit-тесты;

## [1.0.0-beta.0] - 2025-06-12

### Добавлено
- Добавлено использование встроенных в Node.js тестов (unit-tests);

### Удалено
- Удалены разделы "samples" и "site";
- Удалён Jest;

### Обновлено
- Изменена структура папок проекта;
- Файлы шаблонов (hbs) проходят предварительную компиляцию перед использованием;
- Убран Rollup, сборка основана на tsc;
- Изменены настройки GitHub workflows (CI, Deploy);
- Внесены правки в настройки ESLint для улучшения чистоты кода;
- Повышена версия TypeScript;
- Повышена версия Node.js;

## [0.5.1] - 2025-05-15

### Исправлено
- Исправлено содержимое шаблона для генерации файла с кодом сервиса.
- Исправлён путь генерации файлов в unit-тесте (src/index.spec.ts).

## [0.5.1-rc.3] - 2025-05-15

### Добавлено
- Добавлено форматирование hbs шаблонов с помощью prettier

### Исправлено
- Исправлена кроссплатформенная ошибка при вычислении относительных путей

## [0.5.1-rc.2] - 2025-04-08

### Обновлено
- Обновлён механизм вычисления конечного пути: core, models, services, schemas
- Обновлены тесты в соответствии с внесёнными изменениями
- Обновлены примеры кастомных опций для request

### Исправлено
- Исправлен механизм вычисления относительного пути для импорта модели
- Исправлены сломанные тесты

## [0.5.1-rc.1] - 2025-01-21

### Добавлено
- Добавлен тест для функции getAbsolutePath
- Добавлен тест для функции getGatheringRefs

### Исправлено
- Исправлена ошибка при генерации моделей по спецификации, когда схема ссылалась на схему в другом файле, а схема из этого файла ссылалась на схему внутри того же файла.

### Обновлено
- Функция gatheringRefs вынесена в отдельный файл

## [0.5.0-beta.0] - 2024-08-01

### Добавлено
- Добавлена поддержка formData в V3

### Обновлено
- Обновлён тест (test/index.spec.ts) на TypeScript

## [0.4.0-beta.0] - 2023-11-12

### Обновлено
- Обновлены тесты на TypeScript;
- Обновлён расчёт финального пути для сервиса;
- Обновлены файлы запросов;
- Обновлена функция получения URL запроса;
- Обновлён шаблон генерации сервиса.

### Добавлено
- Добавлена возможность указывать собственную конфигурацию OpenApi для запросов.

## [0.3.1-rc.1] - 2023-10-18

### Исправлено
- Исправлена нормализация относительного пути при вычислении относительного пути модели.
- Исправлен механизм расчёта нужного количества переходов вверх по директориям.
- Исправлено значение разделителя пути при формировании относительного пути.

## [0.3.1-rc.0] - 2023-10-12

### Исправлено
- Исправлено преобразование строк в массив строк внутри функции calculateRelationPath (входные параметры).
- Исправлена типизация опций генератора, используемых в функции generate.
- Исправлено использование функции получения относительного пути модели.
- Исправлена логика функции getType для версии 2.
- Исправлена установка префикса для интерфейса (interfacePrefix).
- Исправлена установка префикса для enum (enumPrefix).
- Исправлена установка префикса для type (typePrefix).

### Обновлено
- Обновлён unit-тест для функции getType.
- Обновлён класс Parser для указания версии 2.

### Удалено
- Удалены все неиспользуемые импорты и утилиты.

## [0.3.1-beta.3] - 2023-07-14

### Исправлено
- Исправлена генерация относительных путей импортов и относительного пути модели при генерации на Windows.

### Изменено
- Разделение функционала (OpenAPI) namespace из значений объединено в одну функцию.
- Модифицирована функция соответствия типов под базовые типы Typescript/Javascript — функционал объединён.

### Пропущено
- Пропущена проверка типа getType. Требуется переписать метод по аналогии с getType v3

## [0.3.1-beta.2] - 2023-05-24

### Исправлено
- Удалена функция preProcessWriteModel
- Небольшой рефакторинг кода генерации моделей и схем
- При формировании относительного пути учитывается ситуация, когда корневой каталог не задан
- Формирование относительного пути модели и импорта модели перенесено в функцию getModels

## [0.3.1-beta.1] - 2023-05-15

### Добавлено
- Добавлен unit-тест для функции getRelativeModelImportPath
- Добавлен unit-тест для функции getRelativeModelImportPath

### Исправлено
- Исправлена функция расчёта относительного пути для импорта модели. Теперь учитывается неверное значение параметра относительного пути к модели.

## [0.3.1] - 2023-05-11

### Исправлено
- Исправлен механизм расчёта относительного пути для модели, импорта модели и схемы модели.

## [0.3.0] - 2023-05-11

### Добавлено
- Добавлена опция useCancelableRequest: использование обёртки CancelablePromise для запросов

### Исправлено
- Добавлены отсутствующие параметры в тестах

## [0.2.9] - 2023-04-03

- Обновлён пакет json-schema

## [0.2.8] - 2022-10-19

### Исправлено
- Добавлена функция, проверяющая переход на каталог уровня выше и нормализующая путь.

## [0.2.7] - 2022-10-01

### Добавлено
- Добавлена концепция cancelable

### Исправлено
- Исправлен некорректный тип ошибки в функции catchErrors
- Исправлена версия node в CI
- Исправлены зависимости

## [0.2.6] - 2022-09-18

### Добавлено
- Пример проекта

### Исправлено
- Исправлен некорректный тип клиента

## [0.2.5-beta] - 2022-08-07

### Добавлено
- Поддержка sibling элемента из внешнего файла
- Извлечение параметров запроса для сервиса в отдельный тип
- Вынесен yarn

### Исправлено
- Исправлен некорректный порядок в sortByRequired

## [0.2.3] - 2022-03-20

### Исправлено
- Первый корневой путь в блоке импортов был некорректен, когда модели находились в той же папке, что и серверы (было '/', нужно './')

## [0.2.2] - 2022-02-10

## [0.2.2-beta] - 2022-01-19

### Исправлено
- Внутренние перечисления должны начинаться с заглавной буквы и иметь префикс

## [0.2.1-beta] - 2022-01-15

### Исправлено
- Ошибка с некорректными путями в параметрах ввода генератора

## [0.2.0-beta] - 2021-12-13

### Добавлено
- Добавлена настройка публикации (CI) для релизов
- Общая конфигурация перемещена из массива в корневой блок
- Путь вывода для моделей, сервисов, схем и core можно задавать отдельно

### Исправлено
- Ошибка с некорректным префиксом для enum, если у него было свойство "type"

## [0.1.32] - 2021-12-03

### Исправлено
- Ошибка с контекстом

## [0.1.30] - 2021-12-01

### Добавлено
- Добавлен префикс к имени класса (I - интерфейс, E - enum, T - type)

### Исправлено
- Начало имени класса из компонента блока с заглавной буквы

## [0.1.29] - 2021-11-19

### Добавлено
- Добавлена встроенная поддержка axios

### Исправлено
- Некорректное имя файла при расширении '.yml'

## [0.1.28] - 2021-11-02

### Исправлено
- Ошибки в блоках импорта на Windows (обратный слэш)

## [0.1.27] - 2021-10-30

### Добавлено
- Добавлен CHANGELOG.md